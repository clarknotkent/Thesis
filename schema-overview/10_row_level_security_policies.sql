-- Row-level security policies per table
SELECT
  schemaname AS schema,
  tablename AS table_name,
  policyname AS policy_name,
  permissive,
  roles,
  cmd,
  qual,
  with_check
FROM pg_policies
WHERE schemaname NOT IN ('pg_catalog','information_schema')
ORDER BY schema, table_name, policy_name;

| schema | table_name               | policy_name                        | permissive | roles    | cmd    | qual                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | with_check                                                                                                                                                                                                                                                       |
| ------ | ------------------------ | ---------------------------------- | ---------- | -------- | ------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| cron   | job                      | cron_job_policy                    | PERMISSIVE | {public} | ALL    | (username = CURRENT_USER)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                             |
| cron   | job_run_details          | cron_job_run_details_policy        | PERMISSIVE | {public} | ALL    | (username = CURRENT_USER)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                             |
| public | activitylogs             | activitylogs_admin_read            | PERMISSIVE | {public} | SELECT | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                             |
| public | activitylogs             | activitylogs_insert_any            | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | true                                                                                                                                                                                                                                                             |
| public | birthhistory             | birthhistory_insert                | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                               |
| public | birthhistory             | birthhistory_read                  | PERMISSIVE | {public} | SELECT | (((current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text])) AND (NOT is_deleted)) OR ((patient_id IN ( SELECT p.patient_id
   FROM (patients p
     JOIN guardians g ON ((g.guardian_id = p.guardian_id)))
  WHERE ((g.user_id = current_app_user_id()) AND (p.is_deleted = false)))) AND (NOT is_deleted)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                             |
| public | birthhistory             | birthhistory_update                | PERMISSIVE | {public} | UPDATE | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                               |
| public | conversationparticipants | conversationparticipants_insert    | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                          |
| public | conversationparticipants | conversationparticipants_self_read | PERMISSIVE | {public} | SELECT | ((user_id = current_app_user_id()) OR (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text])))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                             |
| public | conversations            | conversations_insert               | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text, 'HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Guardian'::text]))                                                                                                             |
| public | conversations            | conversations_participant_read     | PERMISSIVE | {public} | SELECT | ((current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text])) OR (EXISTS ( SELECT 1
   FROM conversationparticipants cp
  WHERE ((cp.conversation_id = conversations.conversation_id) AND (cp.user_id = current_app_user_id()) AND (NOT cp.is_deleted)))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                             |
| public | deworming                | deworming_read_clinicians          | PERMISSIVE | {public} | SELECT | ((current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text])) AND (is_deleted = false))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                             |
| public | deworming                | deworming_read_guardians           | PERMISSIVE | {public} | SELECT | ((current_app_role() = 'Guardian'::text) AND (EXISTS ( SELECT 1
   FROM (visits v
     JOIN patients p ON ((p.patient_id = v.patient_id)))
  WHERE ((v.visit_id = deworming.visit_id) AND (p.guardian_id = ( SELECT g.guardian_id
           FROM guardians g
          WHERE (g.user_id = current_app_user_id()))) AND (p.is_deleted = false)))) AND (is_deleted = false))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                             |
| public | deworming                | deworming_update                   | PERMISSIVE | {public} | UPDATE | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                               |
| public | deworming                | deworming_write                    | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                               |
| public | guardians                | guardians_insert                   | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                               |
| public | guardians                | guardians_read                     | PERMISSIVE | {public} | SELECT | (((current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text])) AND (NOT is_deleted)) OR (user_id = current_app_user_id()))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | null                                                                                                                                                                                                                                                             |
| public | guardians                | guardians_update                   | PERMISSIVE | {public} | UPDATE | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                               |
| public | immunizations            | immunizations_insert               | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                     |
| public | immunizations            | immunizations_read                 | PERMISSIVE | {public} | SELECT | (((current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text])) AND (NOT is_deleted)) OR ((NOT is_deleted) AND (( SELECT v.patient_id
   FROM visits v
  WHERE (v.visit_id = immunizations.visit_id)) IN ( SELECT p.patient_id
   FROM (patients p
     JOIN guardians g ON ((g.guardian_id = p.guardian_id)))
  WHERE (g.user_id = current_app_user_id())))) OR ((NOT is_deleted) AND (patient_id IS NOT NULL) AND (patient_id IN ( SELECT p.patient_id
   FROM (patients p
     JOIN guardians g ON ((g.guardian_id = p.guardian_id)))
  WHERE (g.user_id = current_app_user_id())))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                             |
| public | immunizations            | immunizations_update               | PERMISSIVE | {public} | UPDATE | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                     |
| public | inventory                | inventory_insert                   | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                          |
| public | inventory                | inventory_read                     | PERMISSIVE | {public} | SELECT | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                             |
| public | inventory                | inventory_update                   | PERMISSIVE | {public} | UPDATE | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                          |
| public | inventory_requests       | inventory_requests_insert          | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                               |
| public | inventory_requests       | inventory_requests_read            | PERMISSIVE | {public} | SELECT | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                             |
| public | inventory_requests       | inventory_requests_update          | PERMISSIVE | {public} | UPDATE | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                          |
| public | inventorytransactions    | inventorytransactions_insert       | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                               |
| public | inventorytransactions    | inventorytransactions_read         | PERMISSIVE | {public} | SELECT | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                             |
| public | inventorytransactions    | inventorytransactions_update       | PERMISSIVE | {public} | UPDATE | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                          |
| public | messages                 | messages_insert                    | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | ((current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text])) OR (EXISTS ( SELECT 1
   FROM conversationparticipants cp
  WHERE ((cp.conversation_id = messages.conversation_id) AND (cp.user_id = current_app_user_id()) AND (NOT cp.is_deleted))))) |
| public | messages                 | messages_participant_read          | PERMISSIVE | {public} | SELECT | ((current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text])) OR (EXISTS ( SELECT 1
   FROM conversationparticipants cp
  WHERE ((cp.conversation_id = messages.conversation_id) AND (cp.user_id = current_app_user_id()) AND (NOT cp.is_deleted)))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | null                                                                                                                                                                                                                                                             |
| public | notifications            | notifications_insert               | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                          |
| public | notifications            | notifications_read                 | PERMISSIVE | {public} | SELECT | ((current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text])) OR (recipient_user_id = current_app_user_id()))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                             |
| public | patients                 | patients_insert                    | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                               |
| public | patients                 | patients_read                      | PERMISSIVE | {public} | SELECT | (((current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text])) AND (NOT is_deleted)) OR (guardian_id IN ( SELECT g.guardian_id
   FROM guardians g
  WHERE (g.user_id = current_app_user_id()))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                             |
| public | patients                 | patients_update                    | PERMISSIVE | {public} | UPDATE | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                               |
| public | patientschedule          | patientschedule_insert             | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                     |
| public | patientschedule          | patientschedule_read               | PERMISSIVE | {public} | SELECT | (((current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text])) AND (NOT is_deleted)) OR (patient_id IN ( SELECT p.patient_id
   FROM (patients p
     JOIN guardians g ON ((g.guardian_id = p.guardian_id)))
  WHERE (g.user_id = current_app_user_id()))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                             |
| public | patientschedule          | patientschedule_update             | PERMISSIVE | {public} | UPDATE | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                     |
| public | user_mapping             | user_mapping_admin_read            | PERMISSIVE | {public} | SELECT | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                             |
| public | user_mapping             | user_mapping_admin_update          | PERMISSIVE | {public} | UPDATE | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                          |
| public | user_mapping             | user_mapping_admin_write           | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                          |
| public | users                    | users_admin_read                   | PERMISSIVE | {public} | SELECT | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                             |
| public | vaccinemaster            | vaccinemaster_read                 | PERMISSIVE | {public} | SELECT | (current_app_role() = ANY (ARRAY['Admin'::text, 'HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Guardian'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | null                                                                                                                                                                                                                                                             |
| public | vaccinemaster            | vaccinemaster_update               | PERMISSIVE | {public} | UPDATE | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                          |
| public | vaccinemaster            | vaccinemaster_write                | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['Admin'::text, 'service_role'::text]))                                                                                                                                                                                          |
| public | visits                   | visits_insert                      | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                     |
| public | visits                   | visits_read                        | PERMISSIVE | {public} | SELECT | (((current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text])) AND (NOT is_deleted)) OR (patient_id IN ( SELECT p.patient_id
   FROM (patients p
     JOIN guardians g ON ((g.guardian_id = p.guardian_id)))
  WHERE (g.user_id = current_app_user_id()))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                             |
| public | visits                   | visits_update                      | PERMISSIVE | {public} | UPDATE | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                     |
| public | vitalsigns               | vitalsigns_insert                  | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                     |
| public | vitalsigns               | vitalsigns_read                    | PERMISSIVE | {public} | SELECT | (((current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text])) AND (NOT is_deleted)) OR ((NOT is_deleted) AND (( SELECT v.patient_id
   FROM visits v
  WHERE (v.visit_id = vitalsigns.visit_id)) IN ( SELECT p.patient_id
   FROM (patients p
     JOIN guardians g ON ((g.guardian_id = p.guardian_id)))
  WHERE (g.user_id = current_app_user_id())))) OR ((NOT is_deleted) AND (EXISTS ( SELECT 1
   FROM (((immunizations i
     LEFT JOIN visits v ON ((v.visit_id = i.visit_id)))
     JOIN patients p ON ((p.patient_id = COALESCE(i.patient_id, v.patient_id))))
     JOIN guardians g ON ((g.guardian_id = p.guardian_id)))
  WHERE ((i.vital_id = vitalsigns.vital_id) AND (g.user_id = current_app_user_id()) AND (p.is_deleted = false))))) OR ((NOT is_deleted) AND (EXISTS ( SELECT 1
   FROM (((deworming d
     LEFT JOIN visits v ON ((v.visit_id = d.visit_id)))
     JOIN patients p ON ((p.patient_id = COALESCE(d.patient_id, v.patient_id))))
     JOIN guardians g ON ((g.guardian_id = p.guardian_id)))
  WHERE ((d.vital_id = vitalsigns.vital_id) AND (g.user_id = current_app_user_id()) AND (p.is_deleted = false))))) OR ((NOT is_deleted) AND (EXISTS ( SELECT 1
   FROM (((vitamina va
     LEFT JOIN visits v ON ((v.visit_id = va.visit_id)))
     JOIN patients p ON ((p.patient_id = COALESCE(va.patient_id, v.patient_id))))
     JOIN guardians g ON ((g.guardian_id = p.guardian_id)))
  WHERE ((va.vital_id = vitalsigns.vital_id) AND (g.user_id = current_app_user_id()) AND (p.is_deleted = false)))))) | null                                                                                                                                                                                                                                                             |
| public | vitalsigns               | vitalsigns_update                  | PERMISSIVE | {public} | UPDATE | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                     |
| public | vitamina                 | vitamina_read_clinicians           | PERMISSIVE | {public} | SELECT | ((current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text])) AND (is_deleted = false))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                             |
| public | vitamina                 | vitamina_read_guardians            | PERMISSIVE | {public} | SELECT | ((current_app_role() = 'Guardian'::text) AND (EXISTS ( SELECT 1
   FROM (visits v
     JOIN patients p ON ((p.patient_id = v.patient_id)))
  WHERE ((v.visit_id = vitamina.visit_id) AND (p.guardian_id = ( SELECT g.guardian_id
           FROM guardians g
          WHERE (g.user_id = current_app_user_id()))) AND (p.is_deleted = false)))) AND (is_deleted = false))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | null                                                                                                                                                                                                                                                             |
| public | vitamina                 | vitamina_update                    | PERMISSIVE | {public} | UPDATE | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                               |
| public | vitamina                 | vitamina_write                     | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | (current_app_role() = ANY (ARRAY['HealthWorker'::text, 'Nurse'::text, 'Nutritionist'::text, 'Admin'::text, 'service_role'::text]))                                                                                                                               |